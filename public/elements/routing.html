<script src="../bower_components/page/page.js"></script>
<script>
    window.addEventListener('WebComponentsReady', function() {


        // Removes end / from app.baseUrl which page.base requires for production
        if (window.location.port === '') {  // if production
            page.base(app.baseUrl.replace(/\/$/, ''));
        }

        // Middleware
        function scrollToTop(ctx, next) {
            app.scrollPageToTop();
            next();
        }

        function Fixed(ctx, next){
            var header=document.getElementById("headerPanelMain");
            header.removeAttribute("keep-condensed-header")
            header.removeAttribute("condenses")
            header.setAttribute("fixed", "");

            var toolbar=document.getElementById("mainToolbar");
            toolbar.classList.remove("tall")


            var title=document.getElementById("mainTitle");
            title.classList.add("hide");

            var sub_container=document.getElementById("mainSubtitleContainer");
            sub_container.classList.add("plenty");

            next();

        }

        function Condense(ctx, next){
            var header=document.getElementById("headerPanelMain");
            header.setAttribute("keep-condensed-header", "")
            header.setAttribute("condenses", "")
            header.removeAttribute("fixed");

            var toolbar=document.getElementById("mainToolbar");
            toolbar.classList.add("tall")

            var title=document.getElementById("mainTitle");
            title.classList.remove("hide");

            var sub_container=document.getElementById("mainSubtitleContainer");
            sub_container.classList.remove("plenty");


            next();
        }
        
        app.mainTitle="Smart Town";
        
        app.setTitle=function(state){
            document.title= app.mainTitle+" - "+state;
        }

        // Routes
        page('*', scrollToTop, function(ctx, next) {
            next();
        });

        page('/', Condense,  function() {
            app.route = 'home';
            
            app.setTitle("Home")
            
        });

        page(app.baseUrl,  Condense, function() {
            app.route = 'home';
        });

        page('/developer', Fixed, function() {
            app.route = 'developer';
            app.setTitle("Developers")

        });

        page({
            hashbang: true
        });



    });
</script>
